using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Calculator
{
    public partial class frmCalc : Form
    {
        const int OP_NONE = 0;
        const int OP_PLUS = 1;
        const int OP_MINUS = 2;
        const int OP_DIV = 3;
        const int OP_MUL = 4;

        const int OP_EQUAL = 9;

        int op_flag;
        Boolean op_new = false;
        Boolean mem_flag = false;
        decimal x, y, mem;

        public frmCalc()
        {
            //===========================================================================================
            //===========================================================================================
            InitializeComponent();
            //===========================================================================================
        }

        private void frmCalc_Load(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            x = 0;
            y = 0;
            mem = 0;
            op_flag = OP_NONE;
            op_new = true;

            mem_flag = false;
            cmdMC.Enabled = false;
            cmdMR.Enabled = false;

            cmdDiv.Enabled = false;
            cmdPercent.Enabled = false;
            cmdResiprocal.Enabled = false;
            //===========================================================================================
        }

        private void txtDisplay_TextChanged(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (txtDisplay.Text == "0")
            {
                cmdDiv.Enabled = false;
                cmdPercent.Enabled = false;
                cmdResiprocal.Enabled = false;
            }
            else
            {
                cmdDiv.Enabled = true;
                cmdPercent.Enabled = true;
                cmdResiprocal.Enabled = true;
            }
            //===========================================================================================
        }

        private void cmdZero_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdDZero_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if ((txtDisplay.Text == "0") || (op_new == true)) txtDisplay.Text = "0";
            else txtDisplay.Text = txtDisplay.Text + "00";

            op_new = false;
            //===========================================================================================
        }

        private void cmdOne_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdTwo_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdThree_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdFour_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdFive_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdSix_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdSeven_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdEight_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdNine_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void cmdDiv_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (op_flag == OP_NONE || op_flag == OP_EQUAL)
                x = Convert.ToDecimal(txtDisplay.Text);
            else numeriaclOps();

            op_flag = OP_DIV;
            op_new = true;
            //===========================================================================================
        }

        private void cmdMul_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (op_flag == OP_NONE || op_flag == OP_EQUAL)
                x = Convert.ToDecimal(txtDisplay.Text);
            else numeriaclOps();

            op_flag = OP_MUL;
            op_new = true;
            //===========================================================================================
        }

        private void cmdMinus_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (op_flag == OP_NONE || op_flag == OP_EQUAL)
                x = Convert.ToDecimal(txtDisplay.Text);
            else numeriaclOps();

            op_flag = OP_MINUS;
            op_new = true;
            //===========================================================================================
        }

        private void cmdPlus_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (op_flag == OP_NONE || op_flag == OP_EQUAL)
                x = Convert.ToDecimal(txtDisplay.Text);
            else numeriaclOps();

            op_flag = OP_PLUS;
            op_new = true;
            //===========================================================================================
        }

        private void cmdAC_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            x = 0;
            y = 0;
            txtDisplay.Text = "0";
            mem = 0;
            op_flag = OP_NONE;
            op_new = true;
            //===========================================================================================
        }

        private void cmdClear_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            txtDisplay.Text = "0";
            op_new = true;
            //===========================================================================================
        }

        private void cmdPercent_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (txtDisplay.Text != "0")
            {
                txtDisplay.Text = (Convert.ToDecimal(txtDisplay.Text) / 100).ToString();

                op_new = true;
            }
            //===========================================================================================
        }

        private void cmdResiprocal_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            if (txtDisplay.Text != "0")
            {
                txtDisplay.Text = (1 / Convert.ToDecimal(txtDisplay.Text)).ToString();

                op_new = true;
            }
            //===========================================================================================
        }

        private void cmdMPlus_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            mem += Convert.ToDecimal(txtDisplay.Text);

            mem_flag = true;
            cmdMC.Enabled = true;
            cmdMR.Enabled = true;
            //===========================================================================================
        }

        private void cmdMMinus_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            mem -= Convert.ToDecimal(txtDisplay.Text);

            mem_flag = true;
            cmdMC.Enabled = true;
            cmdMR.Enabled = true;
            //===========================================================================================
        }

        private void cmdMC_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            // Memory Clear
            //===========================================================================================
            mem = 0;
            txtDisplay.Text = "0";

            mem_flag = false;
            cmdMC.Enabled = false;
            cmdMR.Enabled = false;
            //===========================================================================================
        }

        private void cmdMR_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            // Memory Recall
            //===========================================================================================
            txtDisplay.Text = mem.ToString();
            //===========================================================================================
        }

        private void cmdEqual_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            // Equal Button
            //===========================================================================================
            numeriaclOps();

            op_flag = OP_EQUAL;
            op_new = true;
            //===========================================================================================
        }
        
        private void cmdDecimal_Click(object sender, EventArgs e)
        {
            //===========================================================================================
            //===========================================================================================
            numberClicked(sender);
            //===========================================================================================
        }

        private void numberClicked(object sender)
        {
            //===========================================================================================
            //===========================================================================================
            if ((txtDisplay.Text == "0") || (op_new == true)) txtDisplay.Text = (sender as Button).Text;
            else txtDisplay.Text = txtDisplay.Text + (sender as Button).Text;

            op_new = false;
            //===========================================================================================
        }

        private void numeriaclOps()
        {
            //===========================================================================================
            //===========================================================================================
            if (op_flag == OP_DIV || op_flag == OP_MUL || op_flag == OP_MINUS || op_flag == OP_PLUS)
            {
                y = Convert.ToDecimal(txtDisplay.Text);

                if (op_flag == OP_DIV) x /= y;
                else if (op_flag == OP_MUL) x *= y;
                else if (op_flag == OP_MINUS) x -= y;
                else if (op_flag == OP_PLUS) x += y;

                txtDisplay.Text = x.ToString();
            }
            //===========================================================================================
        }
    }
}
